---
firewall_state: started
firewall_enabled_at_boot: true
firewall_disable_firewalld: false
firewall_disable_ufw: false
firewall_log_dropped_packets: true

firewall_allowed_tcp_ports: [ '22', '53', '123' ]
firewall_allowed_udp_ports: [ '53', '123' ]
firewall_forwarded_tcp_ports: []
firewall_forwarded_udp_ports: []
firewall_additional_rules:
  - "iptables -P FORWARD DROP"
  - "iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP" # invalid
  - "iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP" # having no data
  - "iptables -t mangle -A PREROUTING -p tcp ! --syn -m state --state NEW -j DROP" # SYNflood
  - "iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP" # stealth scan
  - "iptables -A INPUT -i lo -j ACCEPT"
  - "iptables -A OUTPUT -o lo -j ACCEPT"
  - "iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT"
  #- "iptables -A OUTPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT" # strict mode
  #- "iptables -A OUTPUT -j DROP" # strict mode
  #- "iptables -t mangle -A POSTROUTING -m conntrack --ctstate INVALID -j DROP" # invalid
  #- "iptables -t mangle -A POSTROUTING -p tcp --tcp-flags ALL NONE -j DROP" # having no data
  #- "iptables -t mangle -A POSTROUTING -p tcp ! --syn -m state --state NEW -j DROP" # SYNflood
  #- "iptables -t mangle -A POSTROUTING -p tcp --tcp-flags ALL ALL -j DROP" # stealth scan
firewall_ip6_additional_rules:
  - "ip6tables -P FORWARD DROP"
  - "ip6tables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP" # having no data
  - "ip6tables -t mangle -A PREROUTING -p tcp ! --syn -m state --state NEW -j DROP" # SYNflood
  - "ip6tables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP" # stealth scan
  - "ip6tables -A INPUT -i lo -j ACCEPT"
  - "ip6tables -A OUTPUT -o lo -j ACCEPT"
  - "ip6tables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT"
  #- "ip6tables -A OUTPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT" # strict mode
  #- "ip6tables -A OUTPUT -j DROP" # strict mode
  #- "ip6tables -t mangle -A POSTROUTING -m conntrack --ctstate INVALID -j DROP" # invalid
  #- "ip6tables -t mangle -A POSTROUTING -p tcp --tcp-flags ALL NONE -j DROP" # having no data
  #- "ip6tables -t mangle -A POSTROUTING -p tcp ! --syn -m state --state NEW -j DROP" # SYNflood
  #- "ip6tables -t mangle -A POSTROUTING -p tcp --tcp-flags ALL ALL -j DROP" # stealth scan
